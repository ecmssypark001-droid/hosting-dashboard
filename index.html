<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>호스팅팀 업무 관리</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Inter', sans-serif; 
        }
        
        .nav-item {
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            color: #6B7280;
            border-radius: 0.5rem;
            transition: all 0.2s;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
        }
        
        .nav-item:hover {
            background-color: #F3F4F6;
            color: #111827;
        }
        
        .nav-item.active {
            background-color: #EFF6FF;
            color: #2563EB;
        }
        
        .nav-item i {
            width: 1.25rem;
            margin-right: 0.75rem;
        }
        
        .badge-count {
            background-color: #EF4444;
            color: white;
            font-size: 0.75rem;
            padding: 0.125rem 0.5rem;
            border-radius: 9999px;
            font-weight: 600;
        }
        
        .nav-submenu {
            margin-left: 2rem;
            margin-top: 0.5rem;
            display: none;
        }
        
        .nav-submenu.active {
            display: block;
        }
        
        .nav-submenu-item {
            padding: 0.5rem 1rem;
            color: #6B7280;
            font-size: 0.813rem;
            border-radius: 0.375rem;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .nav-submenu-item:hover {
            background-color: #F9FAFB;
            color: #111827;
        }
        
        .stat-card-modern {
            background: white;
            border: 1px solid #E5E7EB;
            border-radius: 0.75rem;
            padding: 1.5rem;
            transition: all 0.2s;
        }
        
        .stat-card-modern:hover {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        .stat-icon-modern {
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .stat-card-large {
            background: white;
            border: 1px solid #E5E7EB;
            border-radius: 1rem;
            padding: 2rem;
        }
        
        .stat-icon-large {
            width: 3rem;
            height: 3rem;
            border-radius: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .filter-btn-small {
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            border: 1px solid #E5E7EB;
            background: white;
            color: #6B7280;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .filter-btn-small:hover {
            background-color: #F9FAFB;
        }
        
        .filter-btn-small.active {
            background-color: #2563EB;
            color: white;
            border-color: #2563EB;
        }
        
        .btn-primary {
            padding: 0.625rem 1.25rem;
            background-color: #2563EB;
            color: white;
            border-radius: 0.5rem;
            font-weight: 500;
            font-size: 0.875rem;
            cursor: pointer;
            border: none;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
        }
        
        .btn-primary:hover {
            background-color: #1D4ED8;
        }
        
        .task-card {
            background: white;
            border: 1px solid #E5E7EB;
            border-radius: 0.75rem;
            padding: 1.25rem;
            transition: all 0.2s;
            cursor: pointer;
        }
        
        .task-card:hover {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border-color: #2563EB;
        }
        
        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            display: inline-block;
        }
        
        .status-todo { background-color: #F3E8FF; color: #7C3AED; }
        .status-in-progress { background-color: #FEF3C7; color: #D97706; }
        .status-done { background-color: #D1FAE5; color: #059669; }
        .status-delayed { background-color: #FEE2E2; color: #DC2626; }
        
        .member-card {
            background: white;
            border: 1px solid #E5E7EB;
            border-radius: 0.75rem;
            padding: 1.5rem;
        }
        
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
        }
        
        .modal-content {
            background: white;
            border-radius: 1rem;
            padding: 2rem;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 600;
            color: #374151;
            margin-bottom: 0.5rem;
        }
        
        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 0.625rem 0.875rem;
            border: 1px solid #D1D5DB;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            transition: all 0.2s;
        }
        
        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: #2563EB;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
        
        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }
        
        .btn-secondary {
            padding: 0.625rem 1.25rem;
            background-color: #F3F4F6;
            color: #374151;
            border-radius: 0.5rem;
            font-weight: 500;
            font-size: 0.875rem;
            cursor: pointer;
            border: none;
            transition: all 0.2s;
        }
        
        .btn-secondary:hover {
            background-color: #E5E7EB;
        }
        
        .hidden { display: none !important; }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Sidebar -->
    <aside id="sidebar" class="fixed left-0 top-0 h-full w-64 bg-white border-r border-gray-200 z-50">
        <!-- Logo / Header -->
        <div class="h-16 flex items-center px-6 border-b border-gray-200">
            <div class="flex items-center space-x-3">
                <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center">
                    <i class="fas fa-tasks text-white text-sm"></i>
                </div>
                <div>
                    <h1 class="font-bold text-gray-900">호스팅팀</h1>
                    <p class="text-xs text-gray-500">업무 관리</p>
                </div>
            </div>
        </div>

        <!-- User Profile -->
        <div class="px-4 py-4 border-b border-gray-200">
            <div class="flex items-center space-x-3 px-2">
                <div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center text-white font-semibold">
                    박
                </div>
                <div class="flex-1">
                    <p class="font-semibold text-sm text-gray-900">박슬예</p>
                    <p class="text-xs text-gray-500">팀장</p>
                </div>
                <button class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-cog"></i>
                </button>
            </div>
        </div>

        <!-- Navigation -->
        <nav class="p-4 space-y-1">
            <div>
                <a href="#" class="nav-item active" data-tab="work" onclick="switchTab('work')">
                    <i class="fas fa-clipboard-list"></i>
                    <span>업무 현황</span>
                    <span class="ml-auto badge-count" id="nav-work-count">0</span>
                </a>
                <!-- Team Members Submenu -->
                <div class="nav-submenu active" id="work-submenu">
                    <!-- Team member items will be loaded here -->
                </div>
            </div>
            <a href="#" class="nav-item" data-tab="automation" onclick="switchTab('automation')">
                <i class="fas fa-robot"></i>
                <span>자동화 관리</span>
            </a>
            <a href="#" class="nav-item" data-tab="templates" onclick="switchTab('templates')">
                <i class="fas fa-file-alt"></i>
                <span>템플릿</span>
            </a>
        </nav>

        <!-- Team Section (Bottom) -->
        <div class="absolute bottom-0 left-0 right-0 px-4 py-4 border-t border-gray-200 bg-white">
            <p class="text-xs font-semibold text-gray-500 uppercase tracking-wide mb-3 px-2">팀 정보</p>
            <div class="text-xs text-gray-600 px-2 space-y-1">
                <p>총 <span class="font-semibold text-gray-900" id="sidebar-team-count">0</span>명</p>
                <p>진행중 <span class="font-semibold text-blue-600" id="sidebar-active-count">0</span>건</p>
            </div>
        </div>
    </aside>

    <!-- Main Content Area -->
    <main class="ml-64 min-h-screen">
        <!-- Top Bar -->
        <header class="h-16 bg-white border-b border-gray-200 flex items-center justify-between px-8">
            <div class="flex items-center space-x-4">
                <h2 class="text-xl font-bold text-gray-900" id="page-title">업무 현황</h2>
            </div>
            <div class="flex items-center space-x-4">
                <div class="text-sm text-gray-600" id="header-date"></div>
                <button class="w-10 h-10 rounded-lg hover:bg-gray-100 flex items-center justify-center text-gray-600">
                    <i class="fas fa-bell"></i>
                </button>
            </div>
        </header>

        <!-- Work Tab Content -->
        <div id="work-tab" class="tab-content p-8">
            <!-- Top Stats Cards (5 Cards) -->
            <div class="grid grid-cols-5 gap-6 mb-8">
                <!-- Total Tasks -->
                <div class="stat-card-modern">
                    <div class="flex items-center justify-between mb-3">
                        <div class="stat-icon-modern bg-blue-100">
                            <i class="fas fa-list text-blue-600"></i>
                        </div>
                    </div>
                    <div>
                        <p class="text-2xl font-bold text-gray-900" id="total-tasks-count">0</p>
                        <p class="text-sm text-gray-600 mb-2">총 업무</p>
                        <div class="flex items-center text-sm">
                            <span class="text-blue-600 font-semibold" id="total-tasks-percent">100%</span>
                        </div>
                    </div>
                </div>

                <!-- In Progress -->
                <div class="stat-card-modern">
                    <div class="flex items-center justify-between mb-3">
                        <div class="stat-icon-modern bg-yellow-100">
                            <i class="fas fa-spinner text-yellow-600"></i>
                        </div>
                    </div>
                    <div>
                        <p class="text-2xl font-bold text-gray-900" id="in-progress-count">0</p>
                        <p class="text-sm text-gray-600 mb-2">진행중</p>
                        <div class="flex items-center text-sm">
                            <span class="text-yellow-600 font-semibold" id="in-progress-percent">0%</span>
                        </div>
                    </div>
                </div>

                <!-- Delayed -->
                <div class="stat-card-modern">
                    <div class="flex items-center justify-between mb-3">
                        <div class="stat-icon-modern bg-red-100">
                            <i class="fas fa-exclamation-circle text-red-600"></i>
                        </div>
                    </div>
                    <div>
                        <p class="text-2xl font-bold text-gray-900" id="delayed-count">0</p>
                        <p class="text-sm text-gray-600 mb-2">지연중</p>
                        <div class="flex items-center text-sm">
                            <span class="text-red-600 font-semibold" id="delayed-percent">0%</span>
                        </div>
                    </div>
                </div>

                <!-- Todo -->
                <div class="stat-card-modern">
                    <div class="flex items-center justify-between mb-3">
                        <div class="stat-icon-modern bg-purple-100">
                            <i class="fas fa-clock text-purple-600"></i>
                        </div>
                    </div>
                    <div>
                        <p class="text-2xl font-bold text-gray-900" id="todo-count">0</p>
                        <p class="text-sm text-gray-600 mb-2">예정</p>
                        <div class="flex items-center text-sm">
                            <span class="text-purple-600 font-semibold" id="todo-percent">0%</span>
                        </div>
                    </div>
                </div>

                <!-- Completed -->
                <div class="stat-card-modern">
                    <div class="flex items-center justify-between mb-3">
                        <div class="stat-icon-modern bg-green-100">
                            <i class="fas fa-check-circle text-green-600"></i>
                        </div>
                    </div>
                    <div>
                        <p class="text-2xl font-bold text-gray-900" id="completed-count">0</p>
                        <p class="text-sm text-gray-600 mb-2">완료</p>
                        <div class="flex items-center text-sm">
                            <span class="text-green-600 font-semibold" id="completed-percent">0%</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- My Tasks Section -->
            <div class="bg-white rounded-xl border border-gray-200 p-6 mb-8">
                <div class="flex items-center justify-between mb-6">
                    <div>
                        <h3 class="text-xl font-bold text-gray-900">팀 전체 업무</h3>
                        <p class="text-sm text-gray-500 mt-1">마감일 기준으로 정렬됩니다</p>
                    </div>
                    <div class="flex items-center space-x-2">
                        <button onclick="filterWork('all')" class="filter-btn-small active" data-filter="all">All Tasks</button>
                        <button onclick="filterWork('todo')" class="filter-btn-small" data-filter="todo"><i class="fas fa-circle text-purple-500 mr-1"></i>Due Soon</button>
                        <button onclick="filterWork('in_progress')" class="filter-btn-small" data-filter="in_progress"><i class="fas fa-circle text-yellow-500 mr-1"></i>In Progress</button>
                        <button onclick="filterWork('done')" class="filter-btn-small" data-filter="done"><i class="fas fa-circle text-green-500 mr-1"></i>Completed</button>
                    </div>
                </div>
                
                <!-- Tasks List -->
                <div class="space-y-3" id="my-tasks-list">
                    <!-- Tasks will be loaded here -->
                </div>
            </div>

            <!-- Team Member Work Status -->
            <div class="mb-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-bold text-gray-900">개인별 업무 현황</h3>
                    <button onclick="openAddWorkModal()" class="btn-primary">
                        <i class="fas fa-plus mr-2"></i>새 업무 추가
                    </button>
                </div>
                <div class="grid grid-cols-3 gap-6" id="team-member-cards">
                    <!-- Team member cards will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Automation Tab Content -->
        <div id="automation-tab" class="tab-content hidden p-8">
            <div class="flex justify-between items-center mb-8">
                <div>
                    <h3 class="text-2xl font-bold text-gray-900 mb-1">업무 자동화 관리</h3>
                    <p class="text-gray-600">자동화 프로젝트를 추적하고 효율성을 측정하세요</p>
                </div>
                <button onclick="openAddAutomationModal()" class="btn-primary">
                    <i class="fas fa-plus mr-2"></i>새 프로젝트
                </button>
            </div>

            <!-- Automation Stats -->
            <div class="grid grid-cols-4 gap-6 mb-8">
                <div class="stat-card-large">
                    <div class="flex items-center justify-between mb-4">
                        <div class="stat-icon-large bg-green-100">
                            <i class="fas fa-check-circle text-green-600"></i>
                        </div>
                    </div>
                    <p class="text-3xl font-bold text-gray-900 mb-1" id="auto-complete-count">0</p>
                    <p class="text-sm text-gray-600">완료된 프로젝트</p>
                </div>
                <div class="stat-card-large">
                    <div class="flex items-center justify-between mb-4">
                        <div class="stat-icon-large bg-blue-100">
                            <i class="fas fa-spinner text-blue-600"></i>
                        </div>
                    </div>
                    <p class="text-3xl font-bold text-gray-900 mb-1" id="auto-progress-count">0</p>
                    <p class="text-sm text-gray-600">진행중</p>
                </div>
                <div class="stat-card-large">
                    <div class="flex items-center justify-between mb-4">
                        <div class="stat-icon-large bg-purple-100">
                            <i class="fas fa-bolt text-purple-600"></i>
                        </div>
                    </div>
                    <p class="text-3xl font-bold text-gray-900 mb-1"><span id="auto-efficiency">0</span>%</p>
                    <p class="text-sm text-gray-600">평균 효율성</p>
                </div>
                <div class="stat-card-large">
                    <div class="flex items-center justify-between mb-4">
                        <div class="stat-icon-large bg-orange-100">
                            <i class="fas fa-clock text-orange-600"></i>
                        </div>
                    </div>
                    <p class="text-3xl font-bold text-gray-900 mb-1"><span id="auto-time-saved">0</span>h</p>
                    <p class="text-sm text-gray-600">월 절감 시간</p>
                </div>
            </div>

            <div id="automation-list" class="space-y-4"></div>
        </div>

        <!-- Templates Tab Content -->
        <div id="templates-tab" class="tab-content hidden p-8">
            <div class="flex justify-between items-center mb-8">
                <div>
                    <h3 class="text-2xl font-bold text-gray-900 mb-1">프롬프트 템플릿</h3>
                    <p class="text-gray-600">팀 공통 프롬프트 템플릿을 관리하고 사용하세요</p>
                </div>
                <button onclick="openAddTemplateModal()" class="btn-primary">
                    <i class="fas fa-plus mr-2"></i>새 템플릿
                </button>
            </div>
            <div class="grid grid-cols-3 gap-6" id="templates-list"></div>
        </div>
    </main>

    <!-- Modals Container -->
    <div id="modals-container"></div>

    <script>
        // Data Management
        const DATA_KEYS = {
            MEMBERS: 'hosting_team_members',
            TASKS: 'hosting_team_tasks',
            AUTOMATIONS: 'hosting_team_automations',
            TEMPLATES: 'hosting_team_templates'
        };

        // Initialize data structure
        function initializeData() {
            if (!localStorage.getItem(DATA_KEYS.MEMBERS)) {
                const defaultMembers = [
                    { id: 1, name: '정혜인', role: '파트장', avatar: '정' },
                    { id: 2, name: '이엄지', role: '파트장', avatar: '이' },
                    { id: 3, name: '김수인', role: '선임', avatar: '김' },
                    { id: 4, name: '김태훈', role: '파트장', avatar: '김' },
                    { id: 5, name: '박슬예', role: '팀장', avatar: '박' }
                ];
                localStorage.setItem(DATA_KEYS.MEMBERS, JSON.stringify(defaultMembers));
            }
            
            if (!localStorage.getItem(DATA_KEYS.TASKS)) {
                localStorage.setItem(DATA_KEYS.TASKS, JSON.stringify([]));
            }
            
            if (!localStorage.getItem(DATA_KEYS.AUTOMATIONS)) {
                localStorage.setItem(DATA_KEYS.AUTOMATIONS, JSON.stringify([]));
            }
            
            if (!localStorage.getItem(DATA_KEYS.TEMPLATES)) {
                localStorage.setItem(DATA_KEYS.TEMPLATES, JSON.stringify([]));
            }
        }

        // Data getters
        function getMembers() {
            return JSON.parse(localStorage.getItem(DATA_KEYS.MEMBERS)) || [];
        }

        function getTasks() {
            return JSON.parse(localStorage.getItem(DATA_KEYS.TASKS)) || [];
        }

        function getAutomations() {
            return JSON.parse(localStorage.getItem(DATA_KEYS.AUTOMATIONS)) || [];
        }

        function getTemplates() {
            return JSON.parse(localStorage.getItem(DATA_KEYS.TEMPLATES)) || [];
        }

        // Data setters
        function saveTasks(tasks) {
            localStorage.setItem(DATA_KEYS.TASKS, JSON.stringify(tasks));
        }

        function saveAutomations(automations) {
            localStorage.setItem(DATA_KEYS.AUTOMATIONS, JSON.stringify(automations));
        }

        function saveTemplates(templates) {
            localStorage.setItem(DATA_KEYS.TEMPLATES, JSON.stringify(templates));
        }

        // Tab switching
        function switchTab(tabName) {
            // Update nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
            
            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            document.getElementById(`${tabName}-tab`).classList.remove('hidden');
            
            // Update page title
            const titles = {
                work: '업무 현황',
                automation: '자동화 관리',
                templates: '템플릿 관리'
            };
            document.getElementById('page-title').textContent = titles[tabName];
            
            // Refresh data
            if (tabName === 'work') renderWorkTab();
            if (tabName === 'automation') renderAutomationTab();
            if (tabName === 'templates') renderTemplatesTab();
        }

        // Work tab rendering
        function renderWorkTab() {
            const tasks = getTasks();
            const members = getMembers();
            
            // Calculate stats
            const stats = {
                total: tasks.length,
                inProgress: tasks.filter(t => t.status === 'in_progress').length,
                delayed: tasks.filter(t => isDelayed(t)).length,
                todo: tasks.filter(t => t.status === 'todo').length,
                completed: tasks.filter(t => t.status === 'done').length
            };
            
            // Update stat cards
            document.getElementById('total-tasks-count').textContent = stats.total;
            document.getElementById('in-progress-count').textContent = stats.inProgress;
            document.getElementById('delayed-count').textContent = stats.delayed;
            document.getElementById('todo-count').textContent = stats.todo;
            document.getElementById('completed-count').textContent = stats.completed;
            
            // Update percentages
            if (stats.total > 0) {
                document.getElementById('in-progress-percent').textContent = 
                    Math.round((stats.inProgress / stats.total) * 100) + '%';
                document.getElementById('delayed-percent').textContent = 
                    Math.round((stats.delayed / stats.total) * 100) + '%';
                document.getElementById('todo-percent').textContent = 
                    Math.round((stats.todo / stats.total) * 100) + '%';
                document.getElementById('completed-percent').textContent = 
                    Math.round((stats.completed / stats.total) * 100) + '%';
            }
            
            // Render tasks list
            renderTasksList(tasks);
            
            // Render team member cards
            renderTeamMemberCards(members, tasks);
            
            // Render submenu
            renderWorkSubmenu(members, tasks);
            
            // Update sidebar stats
            document.getElementById('sidebar-team-count').textContent = members.length;
            document.getElementById('sidebar-active-count').textContent = stats.inProgress;
            document.getElementById('nav-work-count').textContent = stats.total;
        }

        function renderTasksList(tasks) {
            const container = document.getElementById('my-tasks-list');
            
            if (tasks.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-12 text-gray-500">
                        <i class="fas fa-inbox text-4xl mb-4"></i>
                        <p>등록된 업무가 없습니다</p>
                    </div>
                `;
                return;
            }
            
            // Sort by deadline
            const sortedTasks = [...tasks].sort((a, b) => {
                if (!a.deadline) return 1;
                if (!b.deadline) return -1;
                return new Date(a.deadline) - new Date(b.deadline);
            });
            
            container.innerHTML = sortedTasks.map(task => {
                const member = getMembers().find(m => m.id === task.assigneeId);
                const statusClass = `status-${task.status.replace('_', '-')}`;
                const statusText = {
                    'todo': '예정',
                    'in_progress': '진행중',
                    'done': '완료'
                }[task.status];
                
                const isLate = isDelayed(task);
                
                return `
                    <div class="task-card" onclick="editTask(${task.id})">
                        <div class="flex items-start justify-between">
                            <div class="flex-1">
                                <div class="flex items-center space-x-2 mb-2">
                                    <span class="status-badge ${statusClass}">${statusText}</span>
                                    ${isLate ? '<span class="status-badge status-delayed">지연</span>' : ''}
                                </div>
                                <h4 class="font-semibold text-gray-900 mb-1">${task.title}</h4>
                                <p class="text-sm text-gray-600 mb-3">${task.description || ''}</p>
                                <div class="flex items-center space-x-4 text-xs text-gray-500">
                                    <span><i class="fas fa-user mr-1"></i>${member ? member.name : '미배정'}</span>
                                    ${task.deadline ? `<span><i class="fas fa-calendar mr-1"></i>${formatDate(task.deadline)}</span>` : ''}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function renderTeamMemberCards(members, tasks) {
            const container = document.getElementById('team-member-cards');
            
            container.innerHTML = members.map(member => {
                const memberTasks = tasks.filter(t => t.assigneeId === member.id);
                const activeTasks = memberTasks.filter(t => t.status !== 'done');
                const completedTasks = memberTasks.filter(t => t.status === 'done');
                
                return `
                    <div class="member-card">
                        <div class="flex items-center space-x-3 mb-4">
                            <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center text-white font-semibold">
                                ${member.avatar}
                            </div>
                            <div>
                                <h4 class="font-semibold text-gray-900">${member.name}</h4>
                                <p class="text-sm text-gray-500">${member.role}</p>
                            </div>
                        </div>
                        <div class="space-y-2">
                            <div class="flex justify-between text-sm">
                                <span class="text-gray-600">진행중</span>
                                <span class="font-semibold text-blue-600">${activeTasks.length}건</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span class="text-gray-600">완료</span>
                                <span class="font-semibold text-green-600">${completedTasks.length}건</span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function renderWorkSubmenu(members, tasks) {
            const container = document.getElementById('work-submenu');
            
            container.innerHTML = members.map(member => {
                const memberTasks = tasks.filter(t => t.assigneeId === member.id && t.status !== 'done');
                
                return `
                    <div class="nav-submenu-item">
                        <span>${member.name}</span>
                        <span class="text-xs text-gray-400">${memberTasks.length}</span>
                    </div>
                `;
            }).join('');
        }

        // Filter work
        let currentFilter = 'all';
        function filterWork(filter) {
            currentFilter = filter;
            
            // Update button states
            document.querySelectorAll('.filter-btn-small').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-filter="${filter}"]`).classList.add('active');
            
            // Filter tasks
            const allTasks = getTasks();
            let filteredTasks = allTasks;
            
            if (filter === 'todo') {
                filteredTasks = allTasks.filter(t => t.status === 'todo');
            } else if (filter === 'in_progress') {
                filteredTasks = allTasks.filter(t => t.status === 'in_progress');
            } else if (filter === 'done') {
                filteredTasks = allTasks.filter(t => t.status === 'done');
            }
            
            renderTasksList(filteredTasks);
        }

        // Task management
        function openAddWorkModal() {
            const members = getMembers();
            
            const modal = `
                <div class="modal-overlay" id="add-work-modal" onclick="closeModalOnBackdrop(event)">
                    <div class="modal-content">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-bold text-gray-900">새 업무 추가</h3>
                            <button onclick="closeModal('add-work-modal')" class="text-gray-400 hover:text-gray-600">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        
                        <form onsubmit="saveNewTask(event)">
                            <div class="form-group">
                                <label class="form-label">업무 제목 *</label>
                                <input type="text" class="form-input" id="task-title" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">업무 설명</label>
                                <textarea class="form-textarea" id="task-description"></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">담당자 *</label>
                                <select class="form-select" id="task-assignee" required>
                                    <option value="">담당자 선택</option>
                                    ${members.map(m => `<option value="${m.id}">${m.name} (${m.role})</option>`).join('')}
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">상태 *</label>
                                <select class="form-select" id="task-status" required>
                                    <option value="todo">예정</option>
                                    <option value="in_progress">진행중</option>
                                    <option value="done">완료</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">마감일</label>
                                <input type="date" class="form-input" id="task-deadline">
                            </div>
                            
                            <div class="flex justify-end space-x-3 mt-6">
                                <button type="button" onclick="closeModal('add-work-modal')" class="btn-secondary">
                                    취소
                                </button>
                                <button type="submit" class="btn-primary">
                                    저장
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            
            document.getElementById('modals-container').innerHTML = modal;
        }

        function saveNewTask(event) {
            event.preventDefault();
            
            const tasks = getTasks();
            const newTask = {
                id: Date.now(),
                title: document.getElementById('task-title').value,
                description: document.getElementById('task-description').value,
                assigneeId: parseInt(document.getElementById('task-assignee').value),
                status: document.getElementById('task-status').value,
                deadline: document.getElementById('task-deadline').value || null,
                createdAt: new Date().toISOString()
            };
            
            tasks.push(newTask);
            saveTasks(tasks);
            
            closeModal('add-work-modal');
            renderWorkTab();
        }

        function editTask(taskId) {
            const tasks = getTasks();
            const task = tasks.find(t => t.id === taskId);
            if (!task) return;
            
            const members = getMembers();
            
            const modal = `
                <div class="modal-overlay" id="edit-work-modal" onclick="closeModalOnBackdrop(event)">
                    <div class="modal-content">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-bold text-gray-900">업무 수정</h3>
                            <button onclick="closeModal('edit-work-modal')" class="text-gray-400 hover:text-gray-600">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        
                        <form onsubmit="updateTask(event, ${taskId})">
                            <div class="form-group">
                                <label class="form-label">업무 제목 *</label>
                                <input type="text" class="form-input" id="edit-task-title" value="${task.title}" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">업무 설명</label>
                                <textarea class="form-textarea" id="edit-task-description">${task.description || ''}</textarea>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">담당자 *</label>
                                <select class="form-select" id="edit-task-assignee" required>
                                    ${members.map(m => `
                                        <option value="${m.id}" ${m.id === task.assigneeId ? 'selected' : ''}>
                                            ${m.name} (${m.role})
                                        </option>
                                    `).join('')}
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">상태 *</label>
                                <select class="form-select" id="edit-task-status" required>
                                    <option value="todo" ${task.status === 'todo' ? 'selected' : ''}>예정</option>
                                    <option value="in_progress" ${task.status === 'in_progress' ? 'selected' : ''}>진행중</option>
                                    <option value="done" ${task.status === 'done' ? 'selected' : ''}>완료</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">마감일</label>
                                <input type="date" class="form-input" id="edit-task-deadline" value="${task.deadline || ''}">
                            </div>
                            
                            <div class="flex justify-between mt-6">
                                <button type="button" onclick="deleteTask(${taskId})" class="btn-secondary text-red-600">
                                    <i class="fas fa-trash mr-2"></i>삭제
                                </button>
                                <div class="flex space-x-3">
                                    <button type="button" onclick="closeModal('edit-work-modal')" class="btn-secondary">
                                        취소
                                    </button>
                                    <button type="submit" class="btn-primary">
                                        저장
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            
            document.getElementById('modals-container').innerHTML = modal;
        }

        function updateTask(event, taskId) {
            event.preventDefault();
            
            const tasks = getTasks();
            const taskIndex = tasks.findIndex(t => t.id === taskId);
            
            if (taskIndex !== -1) {
                tasks[taskIndex] = {
                    ...tasks[taskIndex],
                    title: document.getElementById('edit-task-title').value,
                    description: document.getElementById('edit-task-description').value,
                    assigneeId: parseInt(document.getElementById('edit-task-assignee').value),
                    status: document.getElementById('edit-task-status').value,
                    deadline: document.getElementById('edit-task-deadline').value || null,
                    updatedAt: new Date().toISOString()
                };
                
                saveTasks(tasks);
            }
            
            closeModal('edit-work-modal');
            renderWorkTab();
        }

        function deleteTask(taskId) {
            if (!confirm('이 업무를 삭제하시겠습니까?')) return;
            
            const tasks = getTasks();
            const filteredTasks = tasks.filter(t => t.id !== taskId);
            saveTasks(filteredTasks);
            
            closeModal('edit-work-modal');
            renderWorkTab();
        }

        // Automation tab
        function renderAutomationTab() {
            const automations = getAutomations();
            
            // Calculate stats
            const completed = automations.filter(a => a.status === 'completed').length;
            const inProgress = automations.filter(a => a.status === 'in_progress').length;
            const avgEfficiency = automations.length > 0 
                ? Math.round(automations.reduce((sum, a) => sum + (a.efficiency || 0), 0) / automations.length)
                : 0;
            const totalTimeSaved = automations.reduce((sum, a) => sum + (a.timeSaved || 0), 0);
            
            document.getElementById('auto-complete-count').textContent = completed;
            document.getElementById('auto-progress-count').textContent = inProgress;
            document.getElementById('auto-efficiency').textContent = avgEfficiency;
            document.getElementById('auto-time-saved').textContent = totalTimeSaved;
            
            // Render list
            const container = document.getElementById('automation-list');
            
            if (automations.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-12 text-gray-500 bg-white rounded-xl border border-gray-200">
                        <i class="fas fa-robot text-4xl mb-4"></i>
                        <p>등록된 자동화 프로젝트가 없습니다</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = automations.map(auto => {
                const statusClass = auto.status === 'completed' ? 'status-done' : 'status-in-progress';
                const statusText = auto.status === 'completed' ? '완료' : '진행중';
                
                return `
                    <div class="bg-white rounded-xl border border-gray-200 p-6 hover:shadow-md transition-all cursor-pointer" onclick="editAutomation(${auto.id})">
                        <div class="flex items-start justify-between mb-4">
                            <div class="flex-1">
                                <div class="flex items-center space-x-2 mb-2">
                                    <span class="status-badge ${statusClass}">${statusText}</span>
                                </div>
                                <h4 class="font-semibold text-lg text-gray-900 mb-2">${auto.title}</h4>
                                <p class="text-sm text-gray-600">${auto.description || ''}</p>
                            </div>
                        </div>
                        <div class="grid grid-cols-3 gap-4 pt-4 border-t border-gray-200">
                            <div>
                                <p class="text-xs text-gray-500 mb-1">효율성</p>
                                <p class="font-semibold text-purple-600">${auto.efficiency || 0}%</p>
                            </div>
                            <div>
                                <p class="text-xs text-gray-500 mb-1">절감 시간</p>
                                <p class="font-semibold text-orange-600">${auto.timeSaved || 0}h/월</p>
                            </div>
                            <div>
                                <p class="text-xs text-gray-500 mb-1">시작일</p>
                                <p class="font-semibold text-gray-700">${formatDate(auto.startDate)}</p>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function openAddAutomationModal() {
            const modal = `
                <div class="modal-overlay" id="add-automation-modal" onclick="closeModalOnBackdrop(event)">
                    <div class="modal-content">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-bold text-gray-900">새 자동화 프로젝트</h3>
                            <button onclick="closeModal('add-automation-modal')" class="text-gray-400 hover:text-gray-600">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        
                        <form onsubmit="saveNewAutomation(event)">
                            <div class="form-group">
                                <label class="form-label">프로젝트 이름 *</label>
                                <input type="text" class="form-input" id="auto-title" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">설명</label>
                                <textarea class="form-textarea" id="auto-description"></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">상태 *</label>
                                <select class="form-select" id="auto-status" required>
                                    <option value="in_progress">진행중</option>
                                    <option value="completed">완료</option>
                                </select>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">효율성 (%)</label>
                                    <input type="number" class="form-input" id="auto-efficiency" min="0" max="100" value="0">
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">월 절감 시간 (h)</label>
                                    <input type="number" class="form-input" id="auto-time-saved" min="0" value="0">
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">시작일</label>
                                <input type="date" class="form-input" id="auto-start-date">
                            </div>
                            
                            <div class="flex justify-end space-x-3 mt-6">
                                <button type="button" onclick="closeModal('add-automation-modal')" class="btn-secondary">
                                    취소
                                </button>
                                <button type="submit" class="btn-primary">
                                    저장
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            
            document.getElementById('modals-container').innerHTML = modal;
        }

        function saveNewAutomation(event) {
            event.preventDefault();
            
            const automations = getAutomations();
            const newAuto = {
                id: Date.now(),
                title: document.getElementById('auto-title').value,
                description: document.getElementById('auto-description').value,
                status: document.getElementById('auto-status').value,
                efficiency: parseInt(document.getElementById('auto-efficiency').value) || 0,
                timeSaved: parseInt(document.getElementById('auto-time-saved').value) || 0,
                startDate: document.getElementById('auto-start-date').value || new Date().toISOString().split('T')[0],
                createdAt: new Date().toISOString()
            };
            
            automations.push(newAuto);
            saveAutomations(automations);
            
            closeModal('add-automation-modal');
            renderAutomationTab();
        }

        function editAutomation(autoId) {
            const automations = getAutomations();
            const auto = automations.find(a => a.id === autoId);
            if (!auto) return;
            
            const modal = `
                <div class="modal-overlay" id="edit-automation-modal" onclick="closeModalOnBackdrop(event)">
                    <div class="modal-content">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-bold text-gray-900">자동화 프로젝트 수정</h3>
                            <button onclick="closeModal('edit-automation-modal')" class="text-gray-400 hover:text-gray-600">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        
                        <form onsubmit="updateAutomation(event, ${autoId})">
                            <div class="form-group">
                                <label class="form-label">프로젝트 이름 *</label>
                                <input type="text" class="form-input" id="edit-auto-title" value="${auto.title}" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">설명</label>
                                <textarea class="form-textarea" id="edit-auto-description">${auto.description || ''}</textarea>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">상태 *</label>
                                <select class="form-select" id="edit-auto-status" required>
                                    <option value="in_progress" ${auto.status === 'in_progress' ? 'selected' : ''}>진행중</option>
                                    <option value="completed" ${auto.status === 'completed' ? 'selected' : ''}>완료</option>
                                </select>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">효율성 (%)</label>
                                    <input type="number" class="form-input" id="edit-auto-efficiency" min="0" max="100" value="${auto.efficiency || 0}">
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">월 절감 시간 (h)</label>
                                    <input type="number" class="form-input" id="edit-auto-time-saved" min="0" value="${auto.timeSaved || 0}">
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">시작일</label>
                                <input type="date" class="form-input" id="edit-auto-start-date" value="${auto.startDate || ''}">
                            </div>
                            
                            <div class="flex justify-between mt-6">
                                <button type="button" onclick="deleteAutomation(${autoId})" class="btn-secondary text-red-600">
                                    <i class="fas fa-trash mr-2"></i>삭제
                                </button>
                                <div class="flex space-x-3">
                                    <button type="button" onclick="closeModal('edit-automation-modal')" class="btn-secondary">
                                        취소
                                    </button>
                                    <button type="submit" class="btn-primary">
                                        저장
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            
            document.getElementById('modals-container').innerHTML = modal;
        }

        function updateAutomation(event, autoId) {
            event.preventDefault();
            
            const automations = getAutomations();
            const autoIndex = automations.findIndex(a => a.id === autoId);
            
            if (autoIndex !== -1) {
                automations[autoIndex] = {
                    ...automations[autoIndex],
                    title: document.getElementById('edit-auto-title').value,
                    description: document.getElementById('edit-auto-description').value,
                    status: document.getElementById('edit-auto-status').value,
                    efficiency: parseInt(document.getElementById('edit-auto-efficiency').value) || 0,
                    timeSaved: parseInt(document.getElementById('edit-auto-time-saved').value) || 0,
                    startDate: document.getElementById('edit-auto-start-date').value,
                    updatedAt: new Date().toISOString()
                };
                
                saveAutomations(automations);
            }
            
            closeModal('edit-automation-modal');
            renderAutomationTab();
        }

        function deleteAutomation(autoId) {
            if (!confirm('이 자동화 프로젝트를 삭제하시겠습니까?')) return;
            
            const automations = getAutomations();
            const filtered = automations.filter(a => a.id !== autoId);
            saveAutomations(filtered);
            
            closeModal('edit-automation-modal');
            renderAutomationTab();
        }

        // Templates tab
        function renderTemplatesTab() {
            const templates = getTemplates();
            const container = document.getElementById('templates-list');
            
            if (templates.length === 0) {
                container.innerHTML = `
                    <div class="col-span-3 text-center py-12 text-gray-500 bg-white rounded-xl border border-gray-200">
                        <i class="fas fa-file-alt text-4xl mb-4"></i>
                        <p>등록된 템플릿이 없습니다</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = templates.map(template => `
                <div class="bg-white rounded-xl border border-gray-200 p-6 hover:shadow-md transition-all cursor-pointer" onclick="editTemplate(${template.id})">
                    <div class="flex items-start justify-between mb-4">
                        <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-file-alt text-blue-600"></i>
                        </div>
                    </div>
                    <h4 class="font-semibold text-gray-900 mb-2">${template.title}</h4>
                    <p class="text-sm text-gray-600 mb-4">${template.description || ''}</p>
                    <div class="flex items-center justify-between text-xs text-gray-500">
                        <span><i class="fas fa-tag mr-1"></i>${template.category || '일반'}</span>
                        <span><i class="fas fa-clock mr-1"></i>${formatDate(template.createdAt)}</span>
                    </div>
                </div>
            `).join('');
        }

        function openAddTemplateModal() {
            const modal = `
                <div class="modal-overlay" id="add-template-modal" onclick="closeModalOnBackdrop(event)">
                    <div class="modal-content">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-bold text-gray-900">새 템플릿</h3>
                            <button onclick="closeModal('add-template-modal')" class="text-gray-400 hover:text-gray-600">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        
                        <form onsubmit="saveNewTemplate(event)">
                            <div class="form-group">
                                <label class="form-label">템플릿 이름 *</label>
                                <input type="text" class="form-input" id="template-title" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">설명</label>
                                <textarea class="form-textarea" id="template-description" rows="3"></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">카테고리</label>
                                <input type="text" class="form-input" id="template-category" placeholder="예: 보고서, 회의록, 분석">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">템플릿 내용 *</label>
                                <textarea class="form-textarea" id="template-content" rows="10" required></textarea>
                            </div>
                            
                            <div class="flex justify-end space-x-3 mt-6">
                                <button type="button" onclick="closeModal('add-template-modal')" class="btn-secondary">
                                    취소
                                </button>
                                <button type="submit" class="btn-primary">
                                    저장
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            
            document.getElementById('modals-container').innerHTML = modal;
        }

        function saveNewTemplate(event) {
            event.preventDefault();
            
            const templates = getTemplates();
            const newTemplate = {
                id: Date.now(),
                title: document.getElementById('template-title').value,
                description: document.getElementById('template-description').value,
                category: document.getElementById('template-category').value || '일반',
                content: document.getElementById('template-content').value,
                createdAt: new Date().toISOString()
            };
            
            templates.push(newTemplate);
            saveTemplates(templates);
            
            closeModal('add-template-modal');
            renderTemplatesTab();
        }

        function editTemplate(templateId) {
            const templates = getTemplates();
            const template = templates.find(t => t.id === templateId);
            if (!template) return;
            
            const modal = `
                <div class="modal-overlay" id="edit-template-modal" onclick="closeModalOnBackdrop(event)">
                    <div class="modal-content">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-bold text-gray-900">템플릿 수정</h3>
                            <button onclick="closeModal('edit-template-modal')" class="text-gray-400 hover:text-gray-600">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        
                        <form onsubmit="updateTemplate(event, ${templateId})">
                            <div class="form-group">
                                <label class="form-label">템플릿 이름 *</label>
                                <input type="text" class="form-input" id="edit-template-title" value="${template.title}" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">설명</label>
                                <textarea class="form-textarea" id="edit-template-description" rows="3">${template.description || ''}</textarea>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">카테고리</label>
                                <input type="text" class="form-input" id="edit-template-category" value="${template.category || ''}">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">템플릿 내용 *</label>
                                <textarea class="form-textarea" id="edit-template-content" rows="10" required>${template.content}</textarea>
                            </div>
                            
                            <div class="flex justify-between mt-6">
                                <button type="button" onclick="deleteTemplate(${templateId})" class="btn-secondary text-red-600">
                                    <i class="fas fa-trash mr-2"></i>삭제
                                </button>
                                <div class="flex space-x-3">
                                    <button type="button" onclick="closeModal('edit-template-modal')" class="btn-secondary">
                                        취소
                                    </button>
                                    <button type="submit" class="btn-primary">
                                        저장
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            
            document.getElementById('modals-container').innerHTML = modal;
        }

        function updateTemplate(event, templateId) {
            event.preventDefault();
            
            const templates = getTemplates();
            const templateIndex = templates.findIndex(t => t.id === templateId);
            
            if (templateIndex !== -1) {
                templates[templateIndex] = {
                    ...templates[templateIndex],
                    title: document.getElementById('edit-template-title').value,
                    description: document.getElementById('edit-template-description').value,
                    category: document.getElementById('edit-template-category').value,
                    content: document.getElementById('edit-template-content').value,
                    updatedAt: new Date().toISOString()
                };
                
                saveTemplates(templates);
            }
            
            closeModal('edit-template-modal');
            renderTemplatesTab();
        }

        function deleteTemplate(templateId) {
            if (!confirm('이 템플릿을 삭제하시겠습니까?')) return;
            
            const templates = getTemplates();
            const filtered = templates.filter(t => t.id !== templateId);
            saveTemplates(filtered);
            
            closeModal('edit-template-modal');
            renderTemplatesTab();
        }

        // Modal utilities
        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.remove();
            }
        }

        function closeModalOnBackdrop(event) {
            if (event.target.classList.contains('modal-overlay')) {
                event.target.remove();
            }
        }

        // Utility functions
        function formatDate(dateString) {
            if (!dateString) return '';
            const date = new Date(dateString);
            return date.toLocaleDateString('ko-KR', { year: 'numeric', month: 'long', day: 'numeric' });
        }

        function isDelayed(task) {
            if (!task.deadline || task.status === 'done') return false;
            return new Date(task.deadline) < new Date();
        }

        function updateHeaderDate() {
            const now = new Date();
            const formatted = now.toLocaleDateString('ko-KR', { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                weekday: 'long'
            });
            document.getElementById('header-date').textContent = formatted;
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            initializeData();
            updateHeaderDate();
            renderWorkTab();
        });
    </script>
</body>
</html>
